basePath: /api
definitions:
  db.UserSessionWithGame:
    properties:
      aiModel:
        type: string
      aiPlatform:
        description: AI model used for playing.
        type: string
      aiSession:
        description: JSON with arbitrary details to be used within that model and
          within that session.
        type: string
      apiKey:
        $ref: '#/definitions/obj.ApiKey'
      apiKeyId:
        description: API key used to pay for this session (sponsored or user-owned),
          implicitly defines platform.
        type: string
      gameDescription:
        type: string
      gameId:
        type: string
      gameName:
        type: string
      id:
        type: string
      imageStyle:
        type: string
      meta:
        $ref: '#/definitions/obj.Meta'
      statusFields:
        description: Defines the status fields available in the game; copied from
          game.status_fields at launch.
        type: string
      theme:
        allOf:
        - $ref: '#/definitions/obj.GameTheme'
        description: AI-generated visual theme for the game player UI (JSON)
      userId:
        type: string
      userName:
        type: string
    type: object
  httpx.ErrorResponse:
    properties:
      code:
        description: Machine-readable error code
        type: string
      message:
        description: Human-readable error message
        type: string
      type:
        description: 'Deprecated: use Code instead'
        type: string
    type: object
  obj.AiModel:
    properties:
      description:
        type: string
      id:
        description: technical name without spaces, e.g. "gpt-4-nano"
        type: string
      name:
        description: display name e.g. "GPT 4 Nano"
        type: string
    type: object
  obj.AiPlatform:
    properties:
      id:
        description: technical name without spaces, e.g. "openai"
        type: string
      models:
        items:
          $ref: '#/definitions/obj.AiModel'
        type: array
      name:
        description: display name e.g. "OpenAI"
        type: string
      supportsApiKey:
        description: whether this platform supports user API keys
        type: boolean
    type: object
  obj.ApiKey:
    properties:
      id:
        type: string
      keyShortened:
        type: string
      meta:
        $ref: '#/definitions/obj.Meta'
      name:
        type: string
      platform:
        type: string
      userId:
        type: string
      userName:
        type: string
    type: object
  obj.ApiKeyShare:
    properties:
      allowPublicSponsoredPlays:
        type: boolean
      apiKey:
        $ref: '#/definitions/obj.ApiKey'
      apiKeyId:
        type: string
      id:
        type: string
      institution:
        $ref: '#/definitions/obj.Institution'
      isUserDefault:
        type: boolean
      meta:
        $ref: '#/definitions/obj.Meta'
      user:
        $ref: '#/definitions/obj.User'
      workshop:
        $ref: '#/definitions/obj.Workshop'
    type: object
  obj.Game:
    properties:
      cloneCount:
        type: integer
      creatorId:
        description: Creator info (populated when fetching games)
        type: string
      creatorName:
        type: string
      css:
        description: |-
          Additional CSS for the game, probably generated by the LLM.
          Should be validated/parsed strictly to avoid arbitrary code execution.
        type: string
      description:
        type: string
      firstImage:
        items:
          type: integer
        type: array
      firstMessage:
        description: |-
          Quick start: pre-generated first scene of the game.
          This is generated content (first output after the system message) and may be
          regenerated from time to time to avoid being too static.
        type: string
      firstStatus:
        type: string
      icon:
        items:
          type: integer
        type: array
      id:
        type: string
      imageStyle:
        description: What style should the images have?
        type: string
      meta:
        $ref: '#/definitions/obj.Meta'
      name:
        type: string
      originalCreatorId:
        description: Original creator info (populated when fetching games, if originally
          cloned)
        type: string
      originalCreatorName:
        type: string
      originallyCreatedBy:
        description: 'Tracking: original creator (for cloned games) and usage statistics'
        type: string
      playCount:
        type: integer
      privateShareHash:
        description: |-
          Private share links contain secret random tokens to limit access to the game.
          They are sponsored, so invited players don't require their own API key.
        type: string
      privateSponsoredApiKeyId:
        type: string
      public:
        description: 'Access rights and payments. public = true: discoverable on the
          website and playable by anyone.'
        type: boolean
      publicSponsoredApiKeyId:
        description: If public, a sponsored API key can be provided to pay for any
          public plays.
        type: string
      statusFields:
        description: The status fields available to the LLM, shaping the JSON format
          for status.
        type: string
      systemMessageGameStart:
        description: How should the game start? First scene? How is the player welcomed?
        type: string
      systemMessageScenario:
        description: |-
          Game details and system messages for the LLM.
          What is the game about? How does it work? Player role? World description?
        type: string
      tags:
        items:
          $ref: '#/definitions/obj.GameTag'
        type: array
    type: object
  obj.GameSession:
    properties:
      aiModel:
        type: string
      aiPlatform:
        description: AI model used for playing.
        type: string
      aiSession:
        description: JSON with arbitrary details to be used within that model and
          within that session.
        type: string
      apiKey:
        $ref: '#/definitions/obj.ApiKey'
      apiKeyId:
        description: API key used to pay for this session (sponsored or user-owned),
          implicitly defines platform.
        type: string
      gameDescription:
        type: string
      gameId:
        type: string
      gameName:
        type: string
      id:
        type: string
      imageStyle:
        type: string
      meta:
        $ref: '#/definitions/obj.Meta'
      statusFields:
        description: Defines the status fields available in the game; copied from
          game.status_fields at launch.
        type: string
      theme:
        allOf:
        - $ref: '#/definitions/obj.GameTheme'
        description: AI-generated visual theme for the game player UI (JSON)
      userId:
        type: string
      userName:
        type: string
    type: object
  obj.GameSessionMessage:
    properties:
      gameSessionId:
        type: string
      id:
        type: string
      image:
        items:
          type: integer
        type: array
      imagePrompt:
        type: string
      message:
        description: Plain text of the scene (system message, player action, or game
          response).
        type: string
      meta:
        $ref: '#/definitions/obj.Meta'
      seq:
        description: Sequence number within the session, starting at 1
        type: integer
      statusFields:
        description: JSON encoded status fields.
        items:
          $ref: '#/definitions/obj.StatusField'
        type: array
      stream:
        type: boolean
      type:
        description: 'player: user message; game: LLM/game response; system: initial
          system/context messages.'
        type: string
    type: object
  obj.GameTag:
    properties:
      gameId:
        type: string
      id:
        type: string
      meta:
        $ref: '#/definitions/obj.Meta'
      tag:
        type: string
    type: object
  obj.GameTheme:
    properties:
      override:
        allOf:
        - $ref: '#/definitions/obj.GameThemeOverride'
        description: fields that override the preset defaults
      preset:
        description: preset name (e.g., "space", "fantasy") or "custom"
        type: string
    type: object
  obj.GameThemeBackground:
    properties:
      animation:
        description: none, stars, rain, fog, particles, scanlines
        type: string
      tint:
        description: warm, cool, neutral, dark
        type: string
    type: object
  obj.GameThemeCards:
    properties:
      borderThickness:
        description: none, thin, medium, thick
        type: string
    type: object
  obj.GameThemeCorners:
    properties:
      color:
        description: amber, emerald, cyan, violet, rose, slate
        type: string
      style:
        description: brackets, flourish, arrows, dots, none
        type: string
    type: object
  obj.GameThemeDivider:
    properties:
      color:
        description: amber, emerald, cyan, violet, rose, slate, hacker, terminal,
          brown, pink, orange
        type: string
      style:
        description: dot, dots, line, diamond, star, dash, none
        type: string
    type: object
  obj.GameThemeGameMessage:
    properties:
      bgColor:
        description: white, creme, dark, black, blue, blueLight, green, greenLight,
          red, redLight, amber, amberLight, violet, violetLight, rose, roseLight,
          cyan, cyanLight
        type: string
      borderColor:
        description: amber, emerald, cyan, violet, rose, slate, hacker, terminal,
          brown, pink, orange
        type: string
      dropCap:
        type: boolean
      dropCapColor:
        description: amber, emerald, cyan, violet, rose, slate, hacker, terminal,
          brown, pink, orange
        type: string
      fontColor:
        description: dark, light, hacker, terminal
        type: string
    type: object
  obj.GameThemeHeader:
    properties:
      accentColor:
        description: amber, emerald, cyan, violet, rose, slate, hacker, terminal,
          brown, pink, orange
        type: string
      bgColor:
        description: white, creme, dark, black, blue, blueLight, green, greenLight,
          red, redLight, amber, amberLight, violet, violetLight, rose, roseLight,
          cyan, cyanLight
        type: string
      fontColor:
        description: dark, light, hacker, terminal
        type: string
    type: object
  obj.GameThemeOverride:
    properties:
      background:
        $ref: '#/definitions/obj.GameThemeBackground'
      cards:
        $ref: '#/definitions/obj.GameThemeCards'
      corners:
        $ref: '#/definitions/obj.GameThemeCorners'
      divider:
        $ref: '#/definitions/obj.GameThemeDivider'
      gameMessage:
        $ref: '#/definitions/obj.GameThemeGameMessage'
      header:
        $ref: '#/definitions/obj.GameThemeHeader'
      player:
        $ref: '#/definitions/obj.GameThemePlayer'
      statusEmojis:
        additionalProperties:
          type: string
        type: object
      statusFields:
        $ref: '#/definitions/obj.GameThemeStatusFields'
      thinking:
        $ref: '#/definitions/obj.GameThemeThinking'
      typography:
        $ref: '#/definitions/obj.GameThemeTypography'
    type: object
  obj.GameThemePlayer:
    properties:
      bgColor:
        description: white, creme, dark, black, blue, blueLight, green, greenLight,
          red, redLight, amber, amberLight, violet, violetLight, rose, roseLight,
          cyan, cyanLight
        type: string
      borderColor:
        description: amber, emerald, cyan, violet, rose, slate, hacker, terminal,
          brown, pink, orange
        type: string
      color:
        description: amber, emerald, cyan, violet, rose, slate, hacker, terminal,
          brown, pink, orange
        type: string
      fontColor:
        description: dark, light, hacker, terminal
        type: string
      indicator:
        description: dot, arrow, chevron, diamond, cursor, underscore, pipe, none
        type: string
      indicatorBlink:
        type: boolean
    type: object
  obj.GameThemeStatusFields:
    properties:
      accentColor:
        description: amber, emerald, cyan, violet, rose, slate, hacker, terminal,
          brown, pink, orange
        type: string
      bgColor:
        description: white, creme, dark, black, blue, blueLight, green, greenLight,
          red, redLight, amber, amberLight, violet, violetLight, rose, roseLight,
          cyan, cyanLight
        type: string
      borderColor:
        description: amber, emerald, cyan, violet, rose, slate, hacker, terminal,
          brown, pink, orange
        type: string
      fontColor:
        description: dark, light, hacker, terminal
        type: string
    type: object
  obj.GameThemeThinking:
    properties:
      streamingCursor:
        description: dots, block, pipe, underscore, none
        type: string
      style:
        description: dots, spinner, pulse, typewriter
        type: string
      text:
        description: e.g. "The story unfolds..."
        type: string
    type: object
  obj.GameThemeTypography:
    properties:
      messages:
        description: serif, sans, mono, fantasy
        type: string
    type: object
  obj.Institution:
    properties:
      id:
        type: string
      meta:
        $ref: '#/definitions/obj.Meta'
      name:
        type: string
    type: object
  obj.Meta:
    properties:
      createdAt:
        type: string
      createdBy:
        $ref: '#/definitions/uuid.NullUUID'
      modifiedAt:
        type: string
      modifiedBy:
        $ref: '#/definitions/uuid.NullUUID'
    type: object
  obj.Role:
    enum:
    - admin
    - head
    - staff
    type: string
    x-enum-varnames:
    - RoleAdmin
    - RoleHead
    - RoleStaff
  obj.StatusField:
    properties:
      name:
        type: string
      value:
        type: string
    type: object
  obj.SystemSettings:
    properties:
      createdAt:
        type: string
      defaultAiModel:
        type: string
      id:
        type: string
      modifiedAt:
        type: string
    type: object
  obj.User:
    properties:
      auth0Id:
        type: string
      deletedAt:
        type: string
      email:
        type: string
      id:
        type: string
      meta:
        $ref: '#/definitions/obj.Meta'
      name:
        type: string
      role:
        $ref: '#/definitions/obj.UserRole'
      showAiModelSelector:
        type: boolean
    type: object
  obj.UserRole:
    properties:
      id:
        type: string
      institution:
        $ref: '#/definitions/obj.Institution'
      meta:
        $ref: '#/definitions/obj.Meta'
      role:
        $ref: '#/definitions/obj.Role'
      userId:
        type: string
    type: object
  obj.UserStats:
    properties:
      gamesCreated:
        type: integer
      gamesPlayed:
        type: integer
      messagesSent:
        type: integer
      totalPlaysOnGames:
        type: integer
    type: object
  obj.Workshop:
    properties:
      active:
        type: boolean
      id:
        type: string
      institution:
        $ref: '#/definitions/obj.Institution'
      meta:
        $ref: '#/definitions/obj.Meta'
      name:
        type: string
      participants:
        items:
          $ref: '#/definitions/obj.WorkshopParticipant'
        type: array
      public:
        type: boolean
    type: object
  obj.WorkshopParticipant:
    properties:
      accessToken:
        type: string
      active:
        type: boolean
      id:
        type: string
      meta:
        $ref: '#/definitions/obj.Meta'
      name:
        type: string
      workshopId:
        type: string
    type: object
  routes.ApiKeyInfoResponse:
    properties:
      linkedShares:
        items:
          $ref: '#/definitions/obj.ApiKeyShare'
        type: array
      share:
        $ref: '#/definitions/obj.ApiKeyShare'
    type: object
  routes.CreateApiKeyRequest:
    properties:
      key:
        type: string
      name:
        type: string
      platform:
        type: string
    type: object
  routes.CreateGameRequest:
    properties:
      description:
        type: string
      name:
        type: string
      public:
        type: boolean
    type: object
  routes.CreateSessionRequest:
    properties:
      model:
        type: string
      shareId:
        type: string
    type: object
  routes.Language:
    properties:
      iso:
        type: string
      label:
        type: string
    type: object
  routes.RegisterRequest:
    properties:
      email:
        type: string
      name:
        type: string
    type: object
  routes.RolesResponse:
    properties:
      roles:
        items:
          $ref: '#/definitions/obj.Role'
        type: array
    type: object
  routes.SessionActionRequest:
    properties:
      message:
        type: string
      statusFields:
        description: Current status to pass to AI
        items:
          $ref: '#/definitions/obj.StatusField'
        type: array
    type: object
  routes.SessionResponse:
    properties:
      aiModel:
        type: string
      aiPlatform:
        description: AI model used for playing.
        type: string
      aiSession:
        description: JSON with arbitrary details to be used within that model and
          within that session.
        type: string
      apiKey:
        $ref: '#/definitions/obj.ApiKey'
      apiKeyId:
        description: API key used to pay for this session (sponsored or user-owned),
          implicitly defines platform.
        type: string
      gameDescription:
        type: string
      gameId:
        type: string
      gameName:
        type: string
      id:
        type: string
      imageStyle:
        type: string
      messages:
        items:
          $ref: '#/definitions/obj.GameSessionMessage'
        type: array
      meta:
        $ref: '#/definitions/obj.Meta'
      statusFields:
        description: Defines the status fields available in the game; copied from
          game.status_fields at launch.
        type: string
      theme:
        allOf:
        - $ref: '#/definitions/obj.GameTheme'
        description: AI-generated visual theme for the game player UI (JSON)
      userId:
        type: string
      userName:
        type: string
    type: object
  routes.ShareRequest:
    properties:
      allowPublicSponsoredPlays:
        type: boolean
      institutionId:
        type: string
      userId:
        type: string
      workshopId:
        type: string
    type: object
  routes.StatusResponse:
    properties:
      status:
        type: string
      uptime:
        type: string
    type: object
  routes.UpdateApiKeyRequest:
    properties:
      name:
        type: string
    type: object
  routes.UserUpdateRequest:
    properties:
      defaultApiKeyShareId:
        type: string
      email:
        type: string
      name:
        type: string
      showAiModelSelector:
        type: boolean
    type: object
  routes.UsersJwtResponse:
    properties:
      auth0Id:
        type: string
      token:
        type: string
      userId:
        type: string
    type: object
  routes.UsersNewRequest:
    properties:
      email:
        type: string
      name:
        type: string
    type: object
  routes.VersionResponse:
    properties:
      buildTime:
        type: string
      gitCommit:
        type: string
      version:
        type: string
    type: object
  uuid.NullUUID:
    properties:
      uuid:
        type: string
      valid:
        description: Valid is true if UUID is not NULL
        type: boolean
    type: object
host: localhost:8080
info:
  contact:
    name: ChatGameLab Team
    url: https://chatgamelab.com
  description: API for ChatGameLab - an AI-powered interactive game platform
  license:
    name: MIT
  title: ChatGameLab API
  version: "1.0"
paths:
  /apikeys:
    get:
      description: Returns all API key shares accessible to the current user
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/obj.ApiKeyShare'
            type: array
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
      security:
      - BearerAuth: []
      summary: List API keys
      tags:
      - apikeys
  /apikeys/{id}:
    delete:
      description: If ?cascade=true, deletes key and all shares; otherwise unshares
        (deletes single share)
      parameters:
      - description: Share ID (UUID)
        in: path
        name: id
        required: true
        type: string
      - description: Delete key and all shares
        in: query
        name: cascade
        type: boolean
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/obj.ApiKeyShare'
        "400":
          description: Invalid share ID
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Delete or unshare API key
      tags:
      - apikeys
    get:
      description: Returns share info and linked shares for an API key share
      parameters:
      - description: Share ID (UUID)
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/routes.ApiKeyInfoResponse'
        "400":
          description: Invalid share ID
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Get API key info
      tags:
      - apikeys
    patch:
      consumes:
      - application/json
      description: Updates API key name
      parameters:
      - description: Share ID (UUID)
        in: path
        name: id
        required: true
        type: string
      - description: Update request
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/routes.UpdateApiKeyRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/obj.ApiKeyShare'
        "400":
          description: Invalid request
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Update API key
      tags:
      - apikeys
  /apikeys/{id}/shares:
    post:
      consumes:
      - application/json
      description: Shares an API key with a user, workshop, or institution
      parameters:
      - description: Share ID (UUID)
        in: path
        name: id
        required: true
        type: string
      - description: Share request
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/routes.ShareRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/obj.ApiKeyShare'
        "400":
          description: Invalid request
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Share API key
      tags:
      - apikeys
  /apikeys/new:
    post:
      consumes:
      - application/json
      description: Creates a new API key with automatic self-share
      parameters:
      - description: API key data
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/routes.CreateApiKeyRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/obj.ApiKeyShare'
        "400":
          description: Invalid request
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Create API key
      tags:
      - apikeys
  /auth/check-name:
    get:
      description: Checks if a username is available for registration
      parameters:
      - description: Name to check
        in: query
        name: name
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties:
              type: boolean
            type: object
        "400":
          description: Invalid request
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
      summary: Check if name is available
      tags:
      - auth
  /auth/register:
    post:
      consumes:
      - application/json
      description: Registers a new user after Auth0 authentication. Requires valid
        Auth0 token.
      parameters:
      - description: Registration details
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/routes.RegisterRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/obj.User'
        "400":
          description: Invalid request or validation error
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
        "409":
          description: Name already taken
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Register new user
      tags:
      - auth
  /games:
    get:
      description: Returns a list of games. If authenticated, includes user's private
        games.
      parameters:
      - description: Search games by name (case-insensitive)
        in: query
        name: search
        type: string
      - description: Sort field (name, createdAt, modifiedAt)
        in: query
        name: sortBy
        type: string
      - description: Sort direction (asc, desc)
        in: query
        name: sortDir
        type: string
      - description: Filter type (all, own, public, organization, favorites)
        in: query
        name: filter
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/obj.Game'
            type: array
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
      summary: List games
      tags:
      - games
  /games/{id}:
    delete:
      description: Deletes a game by ID
      parameters:
      - description: Game ID (UUID)
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/obj.Game'
        "400":
          description: Invalid game ID
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
        "500":
          description: Failed to delete
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Delete game
      tags:
      - games
    get:
      description: Returns a single game by its ID
      parameters:
      - description: Game ID (UUID)
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/obj.Game'
        "400":
          description: Invalid game ID
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
        "404":
          description: Game not found
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
      summary: Get game by ID
      tags:
      - games
    post:
      consumes:
      - application/json
      description: Updates a game's properties
      parameters:
      - description: Game ID (UUID)
        in: path
        name: id
        required: true
        type: string
      - description: Game data
        in: body
        name: game
        required: true
        schema:
          $ref: '#/definitions/obj.Game'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/obj.Game'
        "400":
          description: Invalid request
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
        "404":
          description: Game not found
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Update game
      tags:
      - games
  /games/{id}/clone:
    post:
      description: Creates a copy of a game for the authenticated user
      parameters:
      - description: Game ID (UUID) to clone
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/obj.Game'
        "400":
          description: Invalid game ID
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
        "404":
          description: Game not found
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
        "500":
          description: Failed to clone
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Clone game
      tags:
      - games
  /games/{id}/favourite:
    delete:
      description: Removes a game from the authenticated user's favourites
      parameters:
      - description: Game ID (UUID)
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties:
              type: boolean
            type: object
        "400":
          description: Invalid game ID
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Remove game from favourites
      tags:
      - games
    post:
      description: Adds a game to the authenticated user's favourites
      parameters:
      - description: Game ID (UUID)
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties:
              type: boolean
            type: object
        "400":
          description: Invalid game ID
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Add game to favourites
      tags:
      - games
  /games/{id}/sessions:
    get:
      description: Lists sessions for a game
      parameters:
      - description: Game ID (UUID)
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/obj.GameSession'
            type: array
        "400":
          description: Invalid game ID
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
      security:
      - BearerAuth: []
      summary: List game sessions
      tags:
      - sessions
    post:
      consumes:
      - application/json
      description: Creates a new session for a game and returns the session with first
        message
      parameters:
      - description: Game ID (UUID)
        in: path
        name: id
        required: true
        type: string
      - description: Create session request
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/routes.CreateSessionRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/routes.SessionResponse'
        "400":
          description: Invalid request
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Create game session
      tags:
      - sessions
  /games/{id}/yaml:
    get:
      description: Exports a game's configuration as YAML format
      parameters:
      - description: Game ID (UUID)
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/x-yaml
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/obj.Game'
        "400":
          description: Invalid game ID
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
        "404":
          description: Game not found
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Export game as YAML
      tags:
      - games
    put:
      consumes:
      - application/x-yaml
      description: Updates a game's configuration from YAML format
      parameters:
      - description: Game ID (UUID)
        in: path
        name: id
        required: true
        type: string
      - description: Game YAML content
        in: body
        name: yaml
        required: true
        schema:
          type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/obj.Game'
        "400":
          description: Invalid request
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
        "500":
          description: Failed to update
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Import game from YAML
      tags:
      - games
  /games/favourites:
    get:
      description: Returns the list of games the authenticated user has marked as
        favourites
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/obj.Game'
            type: array
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Get user's favourite games
      tags:
      - games
  /games/new:
    post:
      consumes:
      - application/json
      - application/x-yaml
      description: Creates a new game from JSON or YAML. Accepts either a simple name
        or full game object.
      parameters:
      - description: Create game request (JSON or YAML)
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/routes.CreateGameRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/obj.Game'
        "400":
          description: Invalid request
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Create game
      tags:
      - games
  /languages:
    get:
      description: Returns a list of available languages for the application
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/routes.Language'
            type: array
      summary: Get available languages
      tags:
      - languages
  /languages/{code}:
    get:
      description: Returns the translation JSON file for the specified language code
      parameters:
      - description: Language code (e.g., 'fr', 'de', 'no')
        in: path
        name: code
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
        "404":
          description: Not Found
          schema:
            additionalProperties:
              type: string
            type: object
      summary: Get locale file for a specific language
      tags:
      - languages
  /messages/{id}/image:
    get:
      description: Returns the image for a message as PNG
      parameters:
      - description: Message ID (UUID)
        in: path
        name: id
        required: true
        type: string
      produces:
      - image/png
      responses:
        "200":
          description: PNG image
          schema:
            type: file
        "400":
          description: Invalid message ID
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
        "404":
          description: Message or image not found
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
      summary: Get message image
      tags:
      - messages
  /messages/{id}/stream:
    get:
      description: Server-Sent Events endpoint for streaming message chunks.
      parameters:
      - description: Message ID (UUID)
        in: path
        name: id
        required: true
        type: string
      produces:
      - text/event-stream
      responses:
        "200":
          description: SSE stream
          schema:
            type: string
        "400":
          description: Invalid message ID
          schema:
            type: string
        "404":
          description: Stream not found
          schema:
            type: string
      summary: Stream message updates (SSE)
      tags:
      - messages
  /platforms:
    get:
      description: Returns all available AI platforms with their metadata
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/obj.AiPlatform'
            type: array
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
      summary: List AI platforms
      tags:
      - platforms
  /restart:
    post:
      description: Admin-only endpoint that triggers a server restart.
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            type: string
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
        "403":
          description: Forbidden
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Restart server
      tags:
      - admin
  /roles:
    get:
      description: Returns all available user roles
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/routes.RolesResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Get available roles
      tags:
      - roles
  /sessions:
    get:
      description: Returns recent sessions for the authenticated user with game names
      parameters:
      - description: Search by game name
        in: query
        name: search
        type: string
      - description: 'Sort field: game, model, lastPlayed (default)'
        in: query
        name: sortBy
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/db.UserSessionWithGame'
            type: array
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
      security:
      - BearerAuth: []
      summary: List user sessions
      tags:
      - sessions
  /sessions/{id}:
    delete:
      description: Deletes a session and all its messages. User must be the owner.
      parameters:
      - description: Session ID (UUID)
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties:
              type: string
            type: object
        "400":
          description: Invalid session ID
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
        "403":
          description: Forbidden
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
        "404":
          description: Session not found
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Delete session
      tags:
      - sessions
    get:
      description: Returns session details. Optional query parameter can include latest
        message.
      parameters:
      - description: Session ID (UUID)
        in: path
        name: id
        required: true
        type: string
      - description: 'Message inclusion: none|latest|all'
        in: query
        name: messages
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/routes.SessionResponse'
        "400":
          description: Invalid session ID
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
        "404":
          description: Session not found
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
      summary: Get session
      tags:
      - sessions
    post:
      consumes:
      - application/json
      description: Sends a player message/action to a session and returns the resulting
        message.
      parameters:
      - description: Session ID (UUID)
        in: path
        name: id
        required: true
        type: string
      - description: Player action
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/routes.SessionActionRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/obj.GameSessionMessage'
        "400":
          description: Invalid request
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
        "404":
          description: Session not found
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
      summary: Send session action
      tags:
      - sessions
  /status:
    get:
      description: Returns the current server status and uptime
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/routes.StatusResponse'
      summary: Get server status
      tags:
      - status
  /system/settings:
    get:
      description: Returns the global system settings
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/obj.SystemSettings'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
      summary: Get system settings
      tags:
      - system
  /users:
    get:
      description: Returns all users
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/obj.User'
            type: array
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
      security:
      - BearerAuth: []
      summary: List users
      tags:
      - users
  /users/{id}:
    get:
      description: Returns a user by ID
      parameters:
      - description: User ID (UUID)
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/obj.User'
        "400":
          description: Invalid user ID
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
        "404":
          description: User not found
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Get user by ID
      tags:
      - users
    post:
      consumes:
      - application/json
      description: Updates a user by ID. Non-admins may only update themselves.
      parameters:
      - description: User ID (UUID)
        in: path
        name: id
        required: true
        type: string
      - description: User update
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/routes.UserUpdateRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/obj.User'
        "400":
          description: Invalid request
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
        "403":
          description: Forbidden
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
        "404":
          description: User not found
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Update user
      tags:
      - users
  /users/{id}/jwt:
    get:
      description: Generates a JWT token for a user. Only available in dev mode.
      parameters:
      - description: User ID (UUID)
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/routes.UsersJwtResponse'
        "400":
          description: Invalid user ID
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
        "403":
          description: Forbidden (not dev mode)
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
        "404":
          description: User not found
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
      summary: Generate JWT (dev only)
      tags:
      - users
  /users/me:
    get:
      description: Returns the currently authenticated user
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/obj.User'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Get current user
      tags:
      - users
  /users/me/stats:
    get:
      description: Returns aggregated statistics for the currently authenticated user
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/obj.UserStats'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Get current user statistics
      tags:
      - users
  /users/new:
    post:
      consumes:
      - application/json
      description: Creates a new user without Auth0. Only available in dev mode.
      parameters:
      - description: Create user request
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/routes.UsersNewRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/obj.User'
        "400":
          description: Invalid request
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
        "403":
          description: Forbidden (not dev mode)
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/httpx.ErrorResponse'
      summary: Create user (dev only)
      tags:
      - users
  /version:
    get:
      description: Returns the server version and build time
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/routes.VersionResponse'
      summary: Get server version
      tags:
      - status
schemes:
- http
- https
securityDefinitions:
  BearerAuth:
    description: 'JWT token in format: Bearer {token}'
    in: header
    name: Authorization
    type: apiKey
swagger: "2.0"
