---
trigger: model_decision
description: Explain and enforce the frontend directory structure and how to place code.
---

You understand and follow this frontend folder structure. When you create or modify code, you place it in the correct folder and keep responsibilities separated. If you are unsure where something belongs, you propose 1–2 options and ask the user to confirm.

## Directory structure (what goes where)

### `api/`
Purpose: Everything related to communicating with the backend API.

- `api/generated/`
  - **Generated code only** (OpenAPI output).
  - Never edit manually.
  - If something is missing/incorrect, fix the generator input/config and regenerate.
  - Keep a `.gitkeep` if the folder would otherwise be empty.

- `api/client/`
  - Hand-written API client glue.
  - Typical contents:
    - `http.ts`: HTTP client setup (base URL, headers, auth token injection, interceptors, error normalization).
    - `index.ts`: exports of the configured client and/or re-exports of generated modules.
  - This is where we adapt generated code to app concerns (Auth0 token, dev mode, logging, retries), not inside `generated`.

**Agent rule:** Prefer consuming API through `api/client` wrappers so the rest of the app doesn’t depend on generator internals.

---

### `assets/`
Purpose: Static assets imported by the frontend (images, icons, etc.).

**Agent rule:** Put only static files here (no TS/React code). Use meaningful names and keep assets organized if the count grows.

---

### `common/`
Purpose: Reusable building blocks shared across multiple features.

- `common/components/`: shared UI components (buttons, layouts, form fields, etc.)
- `common/hooks/`: shared hooks (e.g. `useDebouncedValue`, `useDisclosure` wrappers, etc.)
- `common/lib/`: shared utilities (formatting, fetch helpers, small pure functions)
- `common/types/`: shared domain or utility types used by multiple features

**Agent rules:**
- Before creating anything new, check if `common/` already contains something suitable.
- Put code into `common/` only if it is truly reusable across features; otherwise keep it inside the feature folder.
- Keep `common/` free of feature/business-specific naming.

---

### `config/`
Purpose: Central configuration and singletons.

Current files:
- `config/env.ts`: environment variable parsing / typed env access
- `config/mantineTheme.ts`: Mantine theme setup
- `config/queryClient.ts`: TanStack Query client configuration (defaults, retries, cache)
- `config/router.ts`: Router configuration and router creation

**Agent rules:**
- Configuration belongs here, not scattered across the app.
- Avoid importing application UI components into `config/` (keep it dependency-light).
- Prefer `config/` as the single source of truth for global behavior.

---

### `features/`
Purpose: Feature modules (vertical slices). Each feature owns its UI, hooks, and feature-specific logic.

Recommended internal structure for a feature (create folders as needed):
- `features/<featureName>/components/` (feature-local components)
- `features/<featureName>/hooks/` (feature-local hooks)
- `features/<featureName>/api/` (feature-local API wrappers built on `api/client`)
- `features/<featureName>/types/` (feature-local types)
- `features/<featureName>/utils/` (feature-local helper functions)
- `features/<featureName>/pages/` (optional, if a feature has multiple route-level screens)

**Agent rules:**
- Default to placing new code in `features/` first.
- Only promote to `common/` when reuse is proven or highly likely.
- Features may depend on `common/`, `api/`, and `config/`. `common/` must not depend on `features/`.

---

### `providers/`
Purpose: React provider composition and app-wide context wiring.

- `providers/AppProviders.tsx`
  - Composes MantineProvider, QueryClientProvider, RouterProvider, Auth provider, i18n provider, etc.

**Agent rules:**
- Add new global providers here.
- Keep providers ordered and documented.
- Avoid feature-specific logic inside providers; keep it wiring-only.

---

### `routes/`
Purpose: Route-level components for TanStack Router.

- `routes/__root.tsx`: root route layout (app shell, navigation, shared layout)
- `routes/index.tsx`: the index route (home)

- `routeTree.gen.ts`: generated by TanStack Router; do not edit.

**Agent rules:**
- Route files should be thin: layout, page composition, data-loading boundaries.
- Business logic should live in `features/` (and shared logic in `common/`).
- Never manually edit `routeTree.gen.ts`.

---

## Root-level files (current)
- `main.tsx`: app bootstrap; mounts React, uses `AppProviders`
- `App.tsx`: top-level app component (should stay small; often just delegates to router)
- `App.css`, `index.css`: global styles (minimize; prefer Mantine theme & component styling)

**Agent rules:**
- Avoid putting feature logic in `App.tsx`.
- Keep global CSS minimal; prefer Mantine theme tokens and component-scoped styles.

---

## Dependency direction (important)
To keep the codebase maintainable, follow these dependency rules:

- `features/*` may import from: `common/*`, `api/*`, `config/*`, `providers/*` (sparingly), and `routes/*` (generally no; routes should import features, not vice versa).
- `common/*` may import from: other `common/*` and low-level libs, but **not** `features/*`.
- `config/*` should not import from `features/*` or UI components.
- `routes/*` imports from `features/*` and `common/*` to compose screens.

If a change would violate this, discuss with the user before proceeding.

---

## How the agent should utilize this structure (workflow)
When implementing something:
1. **Locate the scope**
   - Single feature? → implement in `features/<featureName>/...`
   - Cross-feature reusable? → implement/extend in `common/...`
   - Global configuration/provider? → `config/` or `providers/`
   - Backend integration? → use `api/generated` + adapt via `api/client`

2. **Prefer thin routes**
   - Routes compose screens and layouts; features own logic.

3. **Generated code policy**
   - Never edit `api/generated/*` or `routeTree.gen.ts`.
   - Wrap generated API usage in `api/client` and feature-local API helpers.

4. **Document shared components**
   - If you add something to `common/components`, also add it to `docs/components-overview.md` (one line).

## When in doubt
If you are unsure whether something should go in `common/` or `features/`, default to `features/` and only promote later once reuse is clear.